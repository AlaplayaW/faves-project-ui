<div class="add-review card flex flex-column gap-4 h-full p-2">

  <div class="py-2">Quel livre voulez-vous commenter?</div>
  <form [formGroup]="searchForm!">
    <p-autoComplete formControlName="selectedItem" [suggestions]="filteredItems!" [dropdown]="true"
      (completeMethod)="filterItems($event)" 
      placeholder="Recherche un livre" styleClass="w-full">
      <ng-template let-item pTemplate="item">
        <div class="item-container flex">
          <img [src]="item.volumeInfo.imageLinks?.smallThumbnail?? '/assets/empty-star.png'" alt="Book Cover" style="width: 30px;" class="mr-2"/>
          <div class="details-container flex flex-column justify-content-between">
            <div class="title"><strong>{{ item.volumeInfo.title }}</strong></div>
            <div class="author-date">{{ item.volumeInfo.authors[0] }} - {{ item.volumeInfo.publishedDate | date:'yyyy' }}</div>
          </div>
        </div>
      </ng-template>
    </p-autoComplete>
  </form>

  <!-- <input #searchBox type="text" pInputText (keyup)="search(searchBox.value)"
  placeholder="Rechercher par username ou titre" class="flex-auto"/> -->

  <!-- Si le formulaire de création d'un review est affiché -->
  <ng-container *ngIf="showCreateReviewForm">
    <!-- Si un item est sélectionné -->
    <div *ngIf="itemToReview !== undefined" class="card flex flex-column gap-3">
      <app-item-card [item]="itemToReview"></app-item-card>
    </div>
    <div>
      <!-- Créer une nouvelle critique -->
      <!-- <app-create-review-form></app-create-review-form> -->
      <form [formGroup]="createReviewForm" (ngSubmit)="onSubmit()" class="create-review-form gap-3 flex flex-column">
        <label for="rating">Note : {{ this.createReviewForm.value.rating }}</label>
        <p-slider formControlName="rating" [step]="1" [min]="0" [max]="10"></p-slider>

        <label for="comment">Commentaire</label>
        <textarea formControlName="comment" rows="5" cols="30" pInputTextarea></textarea>

        <p-button styleClass="w-full" type="submit" label="Envoyer" [disabled]="!createReviewForm.valid"></p-button>
      </form>
    </div>
  </ng-container>
</div>